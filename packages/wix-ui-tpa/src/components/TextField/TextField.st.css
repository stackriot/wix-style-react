:import {
    -st-from: "../../common/formatters.st";
    -st-named: applyStyleMethod, fallback, applyOpacity, color, font;
}

:import {
    -st-from: "wix-ui-core/index.st.css";
    -st-named: Input;
}

:import {
    -st-from: "../../common/palette.st.css";
    -st-named: errorColor, successColor;
}

:import {
    -st-from: "../IconButton/IconButton.st.css";
    -st-default: TPAIconButton;
}


/*Defaults*/
:vars {
    defaultMainBorderColor: color-5;
    defaultMainBackgroundColor: color-1;
    defaultMainTextColor: color-5;
    defaultLineThemeMainBackgroundColor: transparent;
    defaultMainTextFont: "{theme: 'Body-M', size: '16px'}";
    defaultMainLabelFont: "{theme: 'Body-M', size: '14px', lineHeight: '1.4'}";
    defaultMainLabelTextColor: color-5;
    defaultCharCountFont: "{theme: 'Body-M', size: '14px', lineHeight: '1.4'}";
    defaultCharCountColor: color-4;
}

/*Overrides*/
:vars {
    /*
      The color of the input border
      @default color-5
    */
    MainBorderColor: --overridable;
    /*
      The color of the background of the input
      @default color-1
    */
    MainBackgroundColor: --overridable;
    /*
      The color of the text/placeholder. 60% opacity when disabled and for the placeholder
      @default color-5
    */
    MainTextColor: color-5;
    /*
      The font of the text/placeholder
      @default {theme: 'Body-M', size: '16px'}
    */
    MainTextFont: --overridable;
    /*
      The font of the label
      @default {theme: 'Body-M', size: '14px', lineHeight: '1.4'}
    */
    MainLabelFont: --overridable;
    /*
      The color of the label. 60% opacity when disabled
      @default color-5
    */
    MainLabelTextColor: --overridable;
    /*
      The font of the char count
      @default {theme: 'Body-M', size: '14px', lineHeight: '1.4'}
    */
    CharCountFont: --overridable;
    /*
      The color of the char count
      @default color-4
    */
    CharCountColor: --overridable;
}

:vars {
    mainBorderColor: color(fallback(value(MainBorderColor), value(defaultMainBorderColor)));
    mainBackgroundColor: color(fallback(value(MainBackgroundColor), value(defaultMainBackgroundColor)));
    mainTextColor: color(fallback(value(MainTextColor), value(defaultMainTextColor)));
    mainTextFont: fallback(font(value(MainTextFont)), font(value(defaultMainTextFont)));
    mainLabelTextColor: color(fallback(value(MainLabelTextColor), value(defaultMainLabelTextColor)));
    mainLabelFont: fallback(font(value(MainLabelFont)), font(value(defaultMainLabelFont)));
    mainCharCountFont: fallback(font(value(CharCountFont)), font(value(defaultCharCountFont)));
    mainCharCountColor: color(fallback(value(CharCountColor), value(defaultCharCountColor)));
}

:vars {
    /** default state */
    textColor: value(mainTextColor);
    colorPlaceholder: applyOpacity(value(mainTextColor), 0.6);
    backgroundColor: value(mainBackgroundColor);
    borderColor: value(mainBorderColor);
    border: 1px solid applyOpacity(value(borderColor), 0.6);
    successBorderColor: applyOpacity(value(successColor), 0.6);
    errorBorderColor: applyOpacity(value(errorColor), 0.6);
}

:vars {
    /*Hover*/
    colorHover: value(mainTextColor);
    backgroundColorHover: value(mainBackgroundColor);
    borderColorHover: value(borderColor);
    successBorderColorHover: value(successColor);
    errorBorderColorHover: value(errorColor);
}

:vars {
    /*Focus*/
    colorFocus: value(mainTextColor);
    backgroundColorFocus: value(mainBackgroundColor);
    borderColorFocus: value(borderColor);
    successBorderColorFocus: value(successColor);
    errorBorderColorFocus: value(errorColor);
}

:vars {
    /*Disabled*/
    colorDisabled: applyOpacity(value(mainTextColor), 0.6);
    colorLabelDisabled: applyOpacity(value(mainLabelTextColor), 0.6);
    backgroundColorDisabled: value(mainBackgroundColor);
    borderColorDisabled: applyOpacity(value(mainBorderColor), 0.6);
}

.root {
    -st-states: disabled, error, success;
}

.input {
    -st-extends: Input;
    -st-states: theme(enum(line, box));
    box-sizing: border-box;
    border-color: value(borderColor);
    border-radius: 0;
    transition: border-color .1s ease-in;
    background-color: value(mainBackgroundColor);
    /* todo - Define fonts somewhere*/
    font: value(mainTextFont);
    display: flex;
    align-items: center;
    padding: 0;
}

.input:theme(box) {
    border: value(border);
}

.input:theme(line) {
    border-bottom: value(border);
    background-color: color(fallback(value(MainBackgroundColor), value(defaultLineThemeMainBackgroundColor)));
}

.input:hover {
    border-color: value(borderColorHover);
}

.input:theme(box):hover {
    background-color: value(backgroundColorHover);
}

.input:focus {
    border-color: value(borderColorFocus);
}

.input:theme(box):focus {
    background-color: value(backgroundColorFocus);
}

.root:disabled .input {
    border-color: value(borderColorDisabled);
}

.root:disabled .input:theme(box) {
    background-color: value(backgroundColorDisabled);
}

.root:success .input {
    border-color: value(successBorderColor);
}

.root:success .input:hover {
    border-color: value(successBorderColorHover);
}

.root:success .input:focus {
    border-color: value(successBorderColorFocus);
}

.root:error .input {
    border-color: value(errorBorderColor);
}

.root:error .input:hover {
    border-color: value(errorBorderColorHover);
}

.root:error .input:focus {
    border-color: value(errorBorderColorFocus);
}

.input::nativeInput {
    width: 100%;
    font: value(mainTextFont);
    font-size: 16px;
    line-height: 24px;
    vertical-align: middle;
    border: 0;
    color: value(textColor);
    box-sizing: border-box;
    background-color: transparent;
    padding: 8px 12px;
    margin: 0;
    min-width: 0;
}

.input:theme(line)::nativeInput {
    padding-left: 0;
    padding-right: 0;
}

.input:hover::nativeInput {
    color: value(colorHover);
}

.input:disabled::nativeInput {
    color: value(colorDisabled);
}

.input:focus::nativeInput {
    outline: 0;
    color: value(colorFocus);
}

.input::nativeInput::selection {
    background: applyOpacity(value(mainTextColor), 0.2);
}

.input:theme(line) .suffixWrapper {
    padding: 0;
}

.input:theme(box) .suffixWrapper {
    padding-left: 12px;
    padding-right: 12px;
}
.suffixWrapper {
    height: 24px;
    display: flex;
    margin: 0 -4px;
    justify-content: flex-end;
    white-space: nowrap;
    vertical-align: middle;
}

.gap {
    width: 10px;
}

.clearButtonWrapper {
    height: 100%;
    display: flex;
    align-items: center;
}

.clearButtonGap {
    width: 4px;
    height: 100%;
    display: inline-block;
}

.clearButton {
    -st-extends: TPAIconButton;
    width: 16px;
    height: 16px;
    border-radius: 16px;
    box-sizing: border-box;
    text-align: center;
    outline: 0;
    background-color: applyOpacity(value(mainTextColor), 0.06);
}

/* overrides the IconButton hover & focus styling */
.clearButton:hover, .clearButton:focus {
    opacity: 1;
    background-color: applyOpacity(value(mainTextColor), 0.12);
}

.clearButton::icon {
    line-height: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: value(mainTextColor);
}

.customSuffix {
    color: value(mainTextColor);
    height: 100%;
    display: flex;
}

.customSuffix path {
    fill: value(mainTextColor);
}

/* Placeholder color */
.input::nativeInput::-webkit-input-placeholder,
.input::nativeInput::placeholder
{
    color: value(colorPlaceholder);
}

.label {
    font: value(mainLabelFont);
    color: value(mainLabelTextColor);
    margin-bottom: 8px;
}

.root:disabled .label {
    color: value(colorLabelDisabled);
}

.charCount {
    display: flex;
    justify-content: flex-end;
    margin-top: 8px;
    font: value(mainCharCountFont);
    color: value(mainCharCountColor);
}